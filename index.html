<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<title>üçΩÔ∏è Ecommerce Restaurante - Danilo Gomez</title>

<style>
/* ------------------ PALETA MORADO + BLANCO ------------------ */
:root {
  --morado: #6A0DAD;
  --morado-oscuro: #4b087b;
  --blanco: #ffffff;
  --gris: #f5f5f7;
}

/* ------------------ GLOBAL ------------------ */
body {
  font-family: system-ui;
  background-color: var(--gris);
  color: #333;
  padding: 20px;
  text-align: center;
}

h1 {
  color: var(--morado-oscuro);
}

/* ------------------ PRODUCTOS ------------------ */
#productos {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
}

.producto {
  border: 1px solid #ccc;
  background: var(--blanco);
  border-radius: 8px;
  padding: 10px;
  margin: 10px;
  width: 220px;
}

.producto img {
  width: 100%;
  height: 140px;
  object-fit: cover;
  border-radius: 4px;
}

.producto button {
  background-color: var(--morado);
  border: none;
  color: white;
  padding: 8px;
  margin-top: 5px;
  border-radius: 4px;
  cursor: pointer;
}

/* ------------------ CARRITO ------------------ */
.carrito {
  margin-top: 40px;
  padding: 20px;
  background: var(--blanco);
  border-radius: 8px;
  text-align: left;
  display: inline-block;
  width: 350px;
}

.carrito h2 {
  color: var(--morado-oscuro);
  margin-bottom: 10px;
}

.carrito button.vaciar {
  background-color: #dc3545;
  margin-top: 10px;
  border: none;
  padding: 8px;
  color: white;
  cursor: pointer;
  border-radius: 4px;
}

#btn-finalizar {
  background-color: var(--morado);
  width: 100%;
  margin-top: 10px;
  padding: 10px;
  color: white;
  border-radius: 4px;
  border: none;
  cursor: pointer;
}
</style>
</head>
<body>

<h1>üçΩÔ∏è Ecommerce Restaurante - Danilo Gomez</h1>

<div id="productos"></div>

<div class="carrito">
  <h2>üßæ Carrito de Compras (<span id="cantidad-carrito">0</span>)</h2>

  <ul id="lista-carrito"></ul>

  <p><strong>Total: <span id="total">$0.00</span></strong></p>

  <button class="vaciar" id="btn-vaciar">üßº Vaciar Carrito</button>
  <button id="btn-finalizar" style="display:none;">‚úÖ Finalizar Compra</button>
</div>

<script>
/* ======================================================
   PRODUCTOS DEL RESTAURANTE (SE MANTIENEN TUS IM√ÅGENES)
   ====================================================== */
const productos = [
  {
    id: 1,
    nombre: "Mojarra frita",
    precio: 25.00,
    imagen: "https://th.bing.com/th/id/OIP.yWFgIbLs242r-hWBUDcFfwHaE7?w=274&h=183&c=7&r=0&o=7&pid=1.7&rm=3"
  },
  {
    id: 2,
    nombre: "Camarones al ajillo",
    precio: 18.00,
    imagen: "https://bing.com/th?id=OSK.15c9849eac52f6d7ce8ef4ad3418982b"
  },
  {
    id: 3,
    nombre: "Espinazo de Cerdo",
    precio: 30.00,
    imagen: "https://www.bing.com/images/search?view=detailv2..."
  },
  {
    id: 4,
    nombre: "Filete de Robalo",
    precio: 18.00,
    imagen: "data:image/webp;base64,UklGRlgiAABXRUJQ..."
  },
  {
    id: 5,
    nombre: "Cachama en Salsa",
    precio: 22.00,
    imagen: "data:image/webp;base64,UklGRoIZAABXRUJQ..."
  }
];

/* ======================================================
   CARRITO CON MAP()
   ====================================================== */
const carrito = new Map();

const contenedorProductos = document.getElementById("productos");
const listaCarrito = document.getElementById("lista-carrito");
const totalCarrito = document.getElementById("total");
const cantidadCarrito = document.getElementById("cantidad-carrito");

/* ======================= FORMATEADOR ======================= */
const formato = new Intl.NumberFormat("es-CO", {
  style: "currency",
  currency: "COP"
});

/* ======================================================
   RENDER DE PRODUCTOS
   ====================================================== */
function mostrarProductos() {
  productos.forEach(prod => {
    const div = document.createElement("div");
    div.className = "producto";
    div.innerHTML = `
      <img src="${prod.imagen}" alt="${prod.nombre}">
      <h3>${prod.nombre}</h3>
      <p>${formato.format(prod.precio)}</p>
      <button data-id="${prod.id}">Agregar al carrito</button>
    `;
    contenedorProductos.appendChild(div);
  });
}

/* ======================================================
   AGREGAR AL CARRITO (EVENTOS DELEGADOS)
   ====================================================== */
document.addEventListener("click", (e) => {
  if (e.target.matches(".producto button")) {
    const id = parseInt(e.target.dataset.id);
    const prod = productos.find(p => p.id === id);

    if (carrito.has(id)) {
      carrito.get(id).cantidad++;
    } else {
      carrito.set(id, { ...prod, cantidad: 1 });
    }

    guardarCarrito();
    actualizarCarrito();
  }
});

/* ======================================================
   ACTUALIZAR CARRITO
   ====================================================== */
function actualizarCarrito() {
  listaCarrito.innerHTML = "";
  let total = 0;
  let items = 0;

  carrito.forEach(item => {
    const li = document.createElement("li");
    li.textContent = `${item.nombre} x${item.cantidad} ‚Äî ${formato.format(item.precio * item.cantidad)}`;
    listaCarrito.appendChild(li);
    total += item.precio * item.cantidad;
    items += item.cantidad;
  });

  totalCarrito.textContent = formato.format(total);
  cantidadCarrito.textContent = items;

  document.getElementById("btn-finalizar").style.display = total > 0 ? "block" : "none";
}

/* ======================================================
   VACIAR CARRITO
   ====================================================== */
document.getElementById("btn-vaciar").onclick = () => {
  if (confirm("¬øVaciar carrito?")) {
    carrito.clear();
    guardarCarrito();
    actualizarCarrito();
  }
};

/* ======================================================
   FINALIZAR COMPRA
   ====================================================== */
document.getElementById("btn-finalizar").onclick = () => {
  if (carrito.size === 0) {
    alert("Primero agrega productos.");
    return;
  }
  alert("üéâ ¬°Gracias por tu compra!");
  carrito.clear();
  guardarCarrito();
  actualizarCarrito();
};

/* ======================================================
   LOCAL STORAGE
   ====================================================== */
function guardarCarrito() {
  localStorage.setItem("carritoRestaurante", JSON.stringify([...carrito]));
}

function cargarCarrito() {
  const data = JSON.parse(localStorage.getItem("carritoRestaurante"));
  if (data) {
    data.forEach(([id, item]) => carrito.set(id, item));
  }
  actualizarCarrito();
}

mostrarProductos();
cargarCarrito();
</script>

</body>
</html>
